!function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";function n(t,e,i){const n=(s=e.a,{x:(r=e.b).x-s.x,y:r.y-s.y});var s,r;return{x:t.x+n.x*i,y:t.y+n.y*i}}function s(t,e){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}}function r(t,e){const i=Math.cos(e),n=Math.sin(e);return t.map(({x:t,y:e})=>({x:t*i-e*n,y:t*n+e*i}))}i.r(e);const o=.0025;const a=20;class c{constructor(t){this.svg=t,this.triangle=function(){const t=.5*Math.sqrt(3);return[{x:0,y:-2*t/3},{x:.5,y:t/3},{x:-.5,y:t/3}]}(),this.svgPoints=[u("1.2"),u("1.2"),u("1.2")],this.svgSides=[h(),h(),h()],this.svgHeights=[h({stroke:"grey",strokeWidth:"5",opacity:"0.4"}),h({stroke:"grey",strokeWidth:"5",opacity:"0.4"}),h({stroke:"grey",strokeWidth:"5",opacity:"0.4"})],this.svgNames=[g("1"),g("2"),g("3")];for(let t=0;t<this.svgHeights.length;++t)switch(this.svgHeights[t].setAttribute("cursor","pointer"),t){case 0:this.svgHeights[t].onclick=()=>this.animatePointSwap(1,2);break;case 1:this.svgHeights[t].onclick=()=>this.animatePointSwap(0,2);break;case 2:this.svgHeights[t].onclick=()=>this.animatePointSwap(1,0)}t.append(...this.svgHeights),t.append(...this.svgSides),t.append(...this.svgPoints),t.append(...this.svgNames),this.draw(),setInterval(()=>{if(void 0!==this.animation){const{value:t,done:e}=this.animation.next();e?this.animation=void 0:this.triangle=t,this.draw()}},a)}animateTriangleRotation(t){void 0===this.animation&&(this.animation=function*(t,e,i){const n=2*i*Math.PI/3;let s=0;for(;s<=1;s+=o*t)yield r(e,n*s);1!==s&&(yield r(e,n))}(a,this.triangle,t))}animatePointSwap(t,e){void 0===this.animation&&(this.animation=function*(t,e,i,s){const r={a:e[i],b:e[s]},a={a:e[s],b:e[i]};let c=0;for(;c<=1;c+=o*t){const t=[...e];t[i]=n(e[i],r,c),t[s]=n(e[s],a,c),yield t}if(1!==c){const t=[...e];t[i]=e[s],t[s]=e[i],yield t}}(a,this.triangle,t,e))}draw(){const t=[{a:s((e=this.triangle)[1],e[2]),b:e[0]},{a:s(e[0],e[2]),b:e[1]},{a:s(e[0],e[1]),b:e[2]}];var e;const i=function(t){return[{a:t[0],b:t[1]},{a:t[1],b:t[2]},{a:t[2],b:t[0]}]}(this.triangle);for(let e=0;e<this.triangle.length;++e){const n=this.triangle[e],s=t[e],r=i[e];this.svgHeights[e].setAttribute("x1",(130*s.a.x).toString()),this.svgHeights[e].setAttribute("y1",(130*s.a.y).toString()),this.svgHeights[e].setAttribute("x2",(130*s.b.x).toString()),this.svgHeights[e].setAttribute("y2",(130*s.b.y).toString()),this.svgSides[e].setAttribute("x1",(130*r.a.x).toString()),this.svgSides[e].setAttribute("y1",(130*r.a.y).toString()),this.svgSides[e].setAttribute("x2",(130*r.b.x).toString()),this.svgSides[e].setAttribute("y2",(130*r.b.y).toString()),this.svgPoints[e].setAttribute("cx",(130*n.x).toString()),this.svgPoints[e].setAttribute("cy",(130*n.y).toString());const o={x:n.x,y:n.y-.015};this.svgNames[e].setAttribute("x",(130*o.x).toString()),this.svgNames[e].setAttribute("y",(130*o.y).toString())}}}function u(t){const e=l("circle");return e.setAttribute("r",t),e}function g(t){const e=l("text");return e.setAttribute("text-anchor","middle"),e.setAttribute("style","font-size: 15px"),e.innerHTML=t,e}function h(t={}){const e=l("line");return e.setAttribute("stroke",t.stroke||"black"),void 0!==t.strokeWidth&&e.setAttribute("stroke-width",t.strokeWidth),void 0!==t.opacity&&e.setAttribute("opacity",t.opacity),e}function l(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function d(t,e,i){const n=document.getElementById(t),s=document.getElementById(e),r=document.getElementById(i);if(null===n)throw new Error("No SVG element with requested ID");if(null===s||null===r)throw new Error("No button with requested ID");const o=new c(n);s.onclick=()=>o.animateTriangleRotation(-1),r.onclick=()=>o.animateTriangleRotation(1)}d("left-triangle","left-rotate-1","left-rotate-2"),d("right-triangle","right-rotate-1","right-rotate-2")}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2dlb21ldHJ5LnRzIiwid2VicGFjazovLy8uL3NyYy9hbmltYXRpb25zLnRzIiwid2VicGFjazovLy8uL3NyYy90cmlhbmdsZURyYXdpbmcudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwidHJhbnNsYXRlIiwiZGlzIiwicDEiLCJhIiwieCIsInAyIiwiYiIsInkiLCJtaWRwb2ludCIsInJvdGF0ZVRyaWFuZ2xlIiwiYW5nbGUiLCJjb3MiLCJNYXRoIiwic2luIiwibWFwIiwic3BlZWQiLCJzdmciLCJ0cmlhbmdsZSIsImgiLCJzcXJ0IiwiY3JlYXRlVHJpYW5nbGUiLCJzdmdQb2ludHMiLCJjcmVhdGVTVkdQb2ludCIsInN2Z1NpZGVzIiwiY3JlYXRlU1ZHTGluZSIsInN2Z0hlaWdodHMiLCJzdHJva2UiLCJzdHJva2VXaWR0aCIsIm9wYWNpdHkiLCJzdmdOYW1lcyIsImNyZWF0ZVN2Z1RleHQiLCJ0aGlzIiwibGVuZ3RoIiwic2V0QXR0cmlidXRlIiwib25jbGljayIsImFuaW1hdGVQb2ludFN3YXAiLCJhcHBlbmQiLCJkcmF3Iiwic2V0SW50ZXJ2YWwiLCJ1bmRlZmluZWQiLCJhbmltYXRpb24iLCJuZXdUcmlhbmdsZSIsImRvbmUiLCJuZXh0IiwiZGlyZWN0aW9uIiwidGltZXN0ZXAiLCJQSSIsInRyaWFuZ2xlUm90YXRlQW5pbWF0aW9uIiwiZmlyc3RQb2ludEluZGV4Iiwic2Vjb25kUG9pbnRJbmRleCIsImZpcnN0VG9TZWNvbmQiLCJzZWNvbmRUb0ZpcnN0IiwicG9pbnRTd2FwQW5pbWF0aW9uIiwiaGVpZ2h0cyIsInNpZGVzIiwidHJpYW5nbGVTaWRlcyIsInRvU3RyaW5nIiwibmFtZVBvc2l0aW9uIiwicmFkaXVzIiwiY3JlYXRlU3ZnRWxlbWVudCIsImNvbnRlbnQiLCJ0ZXh0IiwiaW5uZXJIVE1MIiwib3B0aW9ucyIsImxpbmUiLCJ0YWdOYW1lIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50TlMiLCJjcmVhdGVIVE1MVHJpYW5nbGUiLCJzdmdJZCIsImxlZnRSb3RhdGVCdXR0b25JZCIsInJpZ2h0Um90YXRlQnV0dG9uSWQiLCJnZXRFbGVtZW50QnlJZCIsImxlZnRSb3RhdGVCdXR0b24iLCJyaWdodFJvdGF0ZUJ1dHRvbiIsIkVycm9yIiwiZHJhd2luZyIsImFuaW1hdGVUcmlhbmdsZVJvdGF0aW9uIl0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWVi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QUFnQjVELEdBQ3BDeUQsRUFBaUJ2QyxRQUFVLElBQU0wQyxFQUFRQyx5QkFBeUIsR0FDbEVILEVBQWtCeEMsUUFBVSxJQUFNMEMsRUFBUUMsd0JBQXdCLEdBR3RFVCxFQUFtQixnQkFBaUIsZ0JBQWlCLGlCQUNyREEsRUFBbUIsaUJBQWtCLGlCQUFrQiIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJleHBvcnQgaW50ZXJmYWNlIFBvaW50IHtcbiAgICByZWFkb25seSB4OiBudW1iZXJcbiAgICByZWFkb25seSB5OiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBMaW5lIHtcbiAgICByZWFkb25seSBhOiBQb2ludFxuICAgIHJlYWRvbmx5IGI6IFBvaW50XG59XG5cbmV4cG9ydCB0eXBlIFRyaWFuZ2xlID0gcmVhZG9ubHkgUG9pbnRbXVxuXG5leHBvcnQgZnVuY3Rpb24gZGlzcGxhY2VtZW50KHAxOiBQb2ludCwgcDI6IFBvaW50KTogUG9pbnQge1xuICAgIHJldHVybiB7XG4gICAgICAgIHg6IHAyLnggLSBwMS54LFxuICAgICAgICB5OiBwMi55IC0gcDEueSxcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0cmFuc2xhdGUocDogUG9pbnQsIGQ6IExpbmUsIHQ6IG51bWJlcik6IFBvaW50IHtcbiAgICBjb25zdCBkaXMgPSBkaXNwbGFjZW1lbnQoZC5hLCBkLmIpXG4gICAgcmV0dXJuIHtcbiAgICAgICAgeDogcC54ICsgZGlzLnggKiB0LFxuICAgICAgICB5OiBwLnkgKyBkaXMueSAqIHQsXG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbWlkcG9pbnQoYTogUG9pbnQsIGI6IFBvaW50KTogUG9pbnQge1xuICAgIHJldHVybiB7XG4gICAgICAgIHg6IChhLnggKyBiLngpIC8gMixcbiAgICAgICAgeTogKGEueSArIGIueSkgLyAyLFxuICAgIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVRyaWFuZ2xlKCk6IFRyaWFuZ2xlIHtcbiAgICBjb25zdCBhID0gMVxuICAgIGNvbnN0IGggPSBhIC8gMiAqIE1hdGguc3FydCgzKVxuICAgIHJldHVybiBbXG4gICAgICAgIHsgeDogMCwgeTogLTIgKiBoIC8gMyB9LFxuICAgICAgICB7IHg6IGEgLyAyLCB5OiBoIC8gMyB9LFxuICAgICAgICB7IHg6IC1hIC8gMiwgeTogaCAvIDMgfSxcbiAgICBdXG59XG5cbi8qKlxuICogR2VuZXJhdGUgdHJpYW5nbGUgaGVpZ2h0IGxpbmVzLiBUaGUgaXRoIGxpbmUgaXMgYWx3YXlzIGNvbm5lY3RlZCB0byB0aGUgaXRoIHBvaW50XG4gKiBhbmQgdGhlIG1pZGRsZSBvZiB0aGUgb3Bwb3NpdGUgc2lkZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRyaWFuZ2xlSGVpZ2h0cyh0OiBUcmlhbmdsZSk6IFtMaW5lLCBMaW5lLCBMaW5lXSB7XG4gICAgcmV0dXJuIFtcbiAgICAgICAgeyBhOiBtaWRwb2ludCh0WzFdLCB0WzJdKSwgYjogdFswXSB9LFxuICAgICAgICB7IGE6IG1pZHBvaW50KHRbMF0sIHRbMl0pLCBiOiB0WzFdIH0sXG4gICAgICAgIHsgYTogbWlkcG9pbnQodFswXSwgdFsxXSksIGI6IHRbMl0gfSxcbiAgICBdXG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0cmlhbmdsZVNpZGVzKHQ6IFRyaWFuZ2xlKTogW0xpbmUsIExpbmUsIExpbmVdIHtcbiAgICByZXR1cm4gW1xuICAgICAgICB7IGE6IHRbMF0sIGI6IHRbMV0gfSxcbiAgICAgICAgeyBhOiB0WzFdLCBiOiB0WzJdIH0sXG4gICAgICAgIHsgYTogdFsyXSwgYjogdFswXSB9LFxuICAgIF1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRyaWFuZ2xlQ2VudGVyKHQ6IFRyaWFuZ2xlKTogUG9pbnQge1xuICAgIHJldHVybiB7XG4gICAgICAgIHg6ICh0WzBdLnggKyB0WzFdLnggKyB0WzJdLngpIC8gMyxcbiAgICAgICAgeTogKHRbMF0ueSArIHRbMV0ueSArIHRbMl0ueSkgLyAzLFxuICAgIH1cbn1cblxuLyoqXG4gKiBAcmV0dXJucyBUaGUgdHJpYW5nbGUgdCByb3RhdGUgYnkgYW5nbGUgcmFkaWFucy5cbiAqIEBwYXJhbSB0IFRoZSB0YXJnZXQgdHJpYW5nbGUuXG4gKiBAcGFyYW0gYW5nbGUgVGhlIHJvdGF0aW9uIGFuZ2xlIGluIHJhZGlhbnMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByb3RhdGVUcmlhbmdsZSh0OiBUcmlhbmdsZSwgYW5nbGU6IG51bWJlcik6IFRyaWFuZ2xlIHtcbiAgICBjb25zdCBjb3MgPSBNYXRoLmNvcyhhbmdsZSlcbiAgICBjb25zdCBzaW4gPSBNYXRoLnNpbihhbmdsZSlcbiAgICByZXR1cm4gdC5tYXAoKHsgeCwgeSB9KSA9PiAoe1xuICAgICAgICB4OiB4ICogY29zIC0geSAqIHNpbixcbiAgICAgICAgeTogeCAqIHNpbiArIHkgKiBjb3MsXG4gICAgfSkpXG59XG4iLCJpbXBvcnQgeyBUcmlhbmdsZSwgcm90YXRlVHJpYW5nbGUsIGRpc3BsYWNlbWVudCwgdHJhbnNsYXRlIH0gZnJvbSBcIi4vZ2VvbWV0cnlcIlxuXG4vKipcbiAqIEFuIGFuaW1hdGlvbiBpcyBqdXN0IGEgZnVuY3Rpb24gd2hpY2ggcmV0dXJucyBkaWZmZXJlbnQgdHJpYW5nbGVzIHdpdGggdGltZS5cbiAqIFxuICovXG5leHBvcnQgdHlwZSBBbmltYXRpb24gPSBJdGVyYWJsZUl0ZXJhdG9yPFRyaWFuZ2xlPlxuXG5jb25zdCBzcGVlZCA9IDIuNWUtM1xuXG4vKipcbiAqIEByZXR1cm5zIEFuIGFuaW1hdGlvbiB3aGljaCBtb3ZlcyB0aGUgdHdvIHBvaW50cyBzbyB0aGF0IHRoZXkgZW5kIHVwIHN3YXBwZWQuXG4gKiBAcGFyYW0gdCBUaGUgdGFyZ2V0IHRyaWFuZ2xlLlxuICogQHBhcmFtIGZpcnN0UG9pbnRJbmRleCBJbmRleCBvZiBmaXJzdCBwb2ludCB0byBtb3ZlLlxuICogQHBhcmFtIHNlY29uZFBvaW50SW5kZXggSW5kZXggb2Ygc2Vjb25kIHBvaW50IHRvIG1vdmUuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiAqIHBvaW50U3dhcEFuaW1hdGlvbihcbiAgICB0aW1lc3RlcDogbnVtYmVyLFxuICAgIHRyaWFuZ2xlOiBUcmlhbmdsZSxcbiAgICBmaXJzdFBvaW50SW5kZXg6IG51bWJlcixcbiAgICBzZWNvbmRQb2ludEluZGV4OiBudW1iZXIsXG4pOiBJdGVyYWJsZUl0ZXJhdG9yPFRyaWFuZ2xlPiB7XG4gICAgY29uc3QgZmlyc3RUb1NlY29uZCA9IHsgYTogdHJpYW5nbGVbZmlyc3RQb2ludEluZGV4XSwgYjogdHJpYW5nbGVbc2Vjb25kUG9pbnRJbmRleF0gfVxuICAgIGNvbnN0IHNlY29uZFRvRmlyc3QgPSB7IGE6IHRyaWFuZ2xlW3NlY29uZFBvaW50SW5kZXhdLCBiOiB0cmlhbmdsZVtmaXJzdFBvaW50SW5kZXhdIH1cbiAgICBsZXQgdCA9IDBcblxuICAgIGZvciAodDsgdCA8PSAxOyB0ICs9IHNwZWVkICogdGltZXN0ZXApIHtcbiAgICAgICAgY29uc3QgbmV3VHJpYW5nbGUgPSBbLi4udHJpYW5nbGVdXG4gICAgICAgIG5ld1RyaWFuZ2xlW2ZpcnN0UG9pbnRJbmRleF0gPSB0cmFuc2xhdGUodHJpYW5nbGVbZmlyc3RQb2ludEluZGV4XSwgZmlyc3RUb1NlY29uZCwgdClcbiAgICAgICAgbmV3VHJpYW5nbGVbc2Vjb25kUG9pbnRJbmRleF0gPSB0cmFuc2xhdGUodHJpYW5nbGVbc2Vjb25kUG9pbnRJbmRleF0sIHNlY29uZFRvRmlyc3QsIHQpXG4gICAgICAgIHlpZWxkIG5ld1RyaWFuZ2xlXG4gICAgfVxuXG4gICAgaWYgKHQgIT09IDEpIHtcbiAgICAgICAgY29uc3QgbmV3VHJpYW5nbGUgPSBbLi4udHJpYW5nbGVdXG4gICAgICAgIG5ld1RyaWFuZ2xlW2ZpcnN0UG9pbnRJbmRleF0gPSB0cmlhbmdsZVtzZWNvbmRQb2ludEluZGV4XVxuICAgICAgICBuZXdUcmlhbmdsZVtzZWNvbmRQb2ludEluZGV4XSA9IHRyaWFuZ2xlW2ZpcnN0UG9pbnRJbmRleF1cbiAgICAgICAgeWllbGQgbmV3VHJpYW5nbGVcbiAgICB9XG59XG5cbi8qKlxuICogQHJldHVybnMgQW4gYW5pbWF0aW9uIHdoaWNoIHJvdGF0ZXMgdGhlIGdpdmVuIHRyaWFuZ2xlIGZvciAxMjAgZGVncmVlcy5cbiAqIEBwYXJhbSB0IFRoZSB0cmlhbmdsZSB0byByb3RhdGUuXG4gKiBAcGFyYW0gZGlyZWN0aW9uIFRoZSByb3RhdGlvbiBkaXJlY3Rpb24uIDEgbWVhbnMgMTIwIGRlZ3JlZXMsIC0xIG1lYW5zIC0xMjAgZGVncmVlcy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uICogdHJpYW5nbGVSb3RhdGVBbmltYXRpb24oXG4gICAgdGltZXN0ZXA6IG51bWJlcixcbiAgICB0cmlhbmdsZTogVHJpYW5nbGUsXG4gICAgZGlyZWN0aW9uOiBudW1iZXIsXG4pOiBJdGVyYWJsZUl0ZXJhdG9yPFRyaWFuZ2xlPiB7XG4gICAgY29uc3QgYW5nbGUgPSBkaXJlY3Rpb24gKiAyICogTWF0aC5QSSAvIDNcbiAgICBsZXQgdCA9IDBcblxuICAgIGZvciAodDsgdCA8PSAxOyB0ICs9IHNwZWVkICogdGltZXN0ZXApXG4gICAgICAgIHlpZWxkIHJvdGF0ZVRyaWFuZ2xlKHRyaWFuZ2xlLCBhbmdsZSAqIHQpXG5cbiAgICBpZiAodCAhPT0gMSlcbiAgICAgICAgeWllbGQgcm90YXRlVHJpYW5nbGUodHJpYW5nbGUsIGFuZ2xlKVxufVxuIiwiaW1wb3J0IHsgVHJpYW5nbGUsIHRyaWFuZ2xlSGVpZ2h0cywgdHJpYW5nbGVTaWRlcywgY3JlYXRlVHJpYW5nbGUsIHRyYW5zbGF0ZSB9IGZyb20gXCIuL2dlb21ldHJ5XCJcbmltcG9ydCB7IEFuaW1hdGlvbiwgdHJpYW5nbGVSb3RhdGVBbmltYXRpb24sIHBvaW50U3dhcEFuaW1hdGlvbiB9IGZyb20gJy4vYW5pbWF0aW9ucydcblxuY29uc3QgdGltZXN0ZXAgPSAyMFxuXG5leHBvcnQgdHlwZSBIZWlnaHRDbGlja0NhbGxiYWNrID0gKCkgPT4gdm9pZFxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUcmlhbmdsZURyYXdpbmcge1xuICAgIHByaXZhdGUgYW5pbWF0aW9uOiBBbmltYXRpb258dW5kZWZpbmVkXG4gICAgcHJpdmF0ZSB0cmlhbmdsZSA9IGNyZWF0ZVRyaWFuZ2xlKClcbiAgICBwcml2YXRlIHN2Z1BvaW50cyA9IFtjcmVhdGVTVkdQb2ludCgnMS4yJyksIGNyZWF0ZVNWR1BvaW50KCcxLjInKSwgY3JlYXRlU1ZHUG9pbnQoJzEuMicpXVxuICAgIHByaXZhdGUgc3ZnU2lkZXMgPSBbY3JlYXRlU1ZHTGluZSgpLCBjcmVhdGVTVkdMaW5lKCksIGNyZWF0ZVNWR0xpbmUoKV1cbiAgICBwcml2YXRlIHN2Z0hlaWdodHMgPSBbXG4gICAgICAgIGNyZWF0ZVNWR0xpbmUoeyBzdHJva2U6ICdncmV5Jywgc3Ryb2tlV2lkdGg6ICc1Jywgb3BhY2l0eTogJzAuNCcgfSksXG4gICAgICAgIGNyZWF0ZVNWR0xpbmUoeyBzdHJva2U6ICdncmV5Jywgc3Ryb2tlV2lkdGg6ICc1Jywgb3BhY2l0eTogJzAuNCcgfSksXG4gICAgICAgIGNyZWF0ZVNWR0xpbmUoeyBzdHJva2U6ICdncmV5Jywgc3Ryb2tlV2lkdGg6ICc1Jywgb3BhY2l0eTogJzAuNCcgfSksXG4gICAgXVxuICAgIHByaXZhdGUgc3ZnTmFtZXMgPSBbXG4gICAgICAgIGNyZWF0ZVN2Z1RleHQoJzEnKSxcbiAgICAgICAgY3JlYXRlU3ZnVGV4dCgnMicpLFxuICAgICAgICBjcmVhdGVTdmdUZXh0KCczJyksXG4gICAgXVxuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBzdmc6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5zdmdIZWlnaHRzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB0aGlzLnN2Z0hlaWdodHNbaV0uc2V0QXR0cmlidXRlKCdjdXJzb3InLCAncG9pbnRlcicpXG4gICAgICAgICAgICBzd2l0Y2ggKGkpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3ZnSGVpZ2h0c1tpXS5vbmNsaWNrID0gKCkgPT4gdGhpcy5hbmltYXRlUG9pbnRTd2FwKDEsIDIpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN2Z0hlaWdodHNbaV0ub25jbGljayA9ICgpID0+IHRoaXMuYW5pbWF0ZVBvaW50U3dhcCgwLCAyKVxuICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdmdIZWlnaHRzW2ldLm9uY2xpY2sgPSAoKSA9PiB0aGlzLmFuaW1hdGVQb2ludFN3YXAoMSwgMClcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHN2Zy5hcHBlbmQoLi4udGhpcy5zdmdIZWlnaHRzKVxuICAgICAgICBzdmcuYXBwZW5kKC4uLnRoaXMuc3ZnU2lkZXMpXG4gICAgICAgIHN2Zy5hcHBlbmQoLi4udGhpcy5zdmdQb2ludHMpXG4gICAgICAgIHN2Zy5hcHBlbmQoLi4udGhpcy5zdmdOYW1lcylcblxuICAgICAgICB0aGlzLmRyYXcoKVxuXG4gICAgICAgIHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmFuaW1hdGlvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyB2YWx1ZTogbmV3VHJpYW5nbGUsIGRvbmUgfSA9IHRoaXMuYW5pbWF0aW9uLm5leHQoKVxuICAgICAgICAgICAgICAgIGlmICghZG9uZSlcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50cmlhbmdsZSA9IG5ld1RyaWFuZ2xlXG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFuaW1hdGlvbiA9IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgIHRoaXMuZHJhdygpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHRpbWVzdGVwKVxuICAgIH1cblxuICAgIHB1YmxpYyBhbmltYXRlVHJpYW5nbGVSb3RhdGlvbihkaXJlY3Rpb246IG51bWJlcikge1xuICAgICAgICBpZiAodGhpcy5hbmltYXRpb24gIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB0aGlzLmFuaW1hdGlvbiA9IHRyaWFuZ2xlUm90YXRlQW5pbWF0aW9uKHRpbWVzdGVwLCB0aGlzLnRyaWFuZ2xlLCBkaXJlY3Rpb24pXG4gICAgfVxuXG4gICAgcHVibGljIGFuaW1hdGVQb2ludFN3YXAoZmlyc3RQb2ludEluZGV4OiBudW1iZXIsIHNlY29uZFBvaW50SW5kZXg6IG51bWJlcikge1xuICAgICAgICBpZiAodGhpcy5hbmltYXRpb24gIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB0aGlzLmFuaW1hdGlvbiA9IHBvaW50U3dhcEFuaW1hdGlvbih0aW1lc3RlcCwgdGhpcy50cmlhbmdsZSwgZmlyc3RQb2ludEluZGV4LCBzZWNvbmRQb2ludEluZGV4KVxuICAgIH1cblxuICAgIHByaXZhdGUgZHJhdygpOiB2b2lkIHtcbiAgICAgICAgY29uc3Qgc2NhbGluZyA9IDEzMFxuICAgICAgICBjb25zdCBoZWlnaHRzID0gdHJpYW5nbGVIZWlnaHRzKHRoaXMudHJpYW5nbGUpXG4gICAgICAgIGNvbnN0IHNpZGVzID0gdHJpYW5nbGVTaWRlcyh0aGlzLnRyaWFuZ2xlKVxuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy50cmlhbmdsZS5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgY29uc3QgcCA9IHRoaXMudHJpYW5nbGVbaV1cbiAgICAgICAgICAgIGNvbnN0IGggPSBoZWlnaHRzW2ldXG4gICAgICAgICAgICBjb25zdCBzID0gc2lkZXNbaV1cblxuICAgICAgICAgICAgdGhpcy5zdmdIZWlnaHRzW2ldLnNldEF0dHJpYnV0ZSgneDEnLCAoaC5hLnggKiBzY2FsaW5nKS50b1N0cmluZygpKVxuICAgICAgICAgICAgdGhpcy5zdmdIZWlnaHRzW2ldLnNldEF0dHJpYnV0ZSgneTEnLCAoaC5hLnkgKiBzY2FsaW5nKS50b1N0cmluZygpKVxuICAgICAgICAgICAgdGhpcy5zdmdIZWlnaHRzW2ldLnNldEF0dHJpYnV0ZSgneDInLCAoaC5iLnggKiBzY2FsaW5nKS50b1N0cmluZygpKVxuICAgICAgICAgICAgdGhpcy5zdmdIZWlnaHRzW2ldLnNldEF0dHJpYnV0ZSgneTInLCAoaC5iLnkgKiBzY2FsaW5nKS50b1N0cmluZygpKVxuICAgICAgICAgICAgdGhpcy5zdmdTaWRlc1tpXS5zZXRBdHRyaWJ1dGUoJ3gxJywgKHMuYS54ICogc2NhbGluZykudG9TdHJpbmcoKSlcbiAgICAgICAgICAgIHRoaXMuc3ZnU2lkZXNbaV0uc2V0QXR0cmlidXRlKCd5MScsIChzLmEueSAqIHNjYWxpbmcpLnRvU3RyaW5nKCkpXG4gICAgICAgICAgICB0aGlzLnN2Z1NpZGVzW2ldLnNldEF0dHJpYnV0ZSgneDInLCAocy5iLnggKiBzY2FsaW5nKS50b1N0cmluZygpKVxuICAgICAgICAgICAgdGhpcy5zdmdTaWRlc1tpXS5zZXRBdHRyaWJ1dGUoJ3kyJywgKHMuYi55ICogc2NhbGluZykudG9TdHJpbmcoKSlcbiAgICAgICAgICAgIHRoaXMuc3ZnUG9pbnRzW2ldLnNldEF0dHJpYnV0ZSgnY3gnLCAocC54ICogc2NhbGluZykudG9TdHJpbmcoKSlcbiAgICAgICAgICAgIHRoaXMuc3ZnUG9pbnRzW2ldLnNldEF0dHJpYnV0ZSgnY3knLCAocC55ICogc2NhbGluZykudG9TdHJpbmcoKSlcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgbmFtZVBvc2l0aW9uID0ge1xuICAgICAgICAgICAgICAgIHg6IHAueCxcbiAgICAgICAgICAgICAgICB5OiBwLnkgLSAwLjAxNSxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc3ZnTmFtZXNbaV0uc2V0QXR0cmlidXRlKCd4JywgKG5hbWVQb3NpdGlvbi54ICogc2NhbGluZykudG9TdHJpbmcoKSlcbiAgICAgICAgICAgIHRoaXMuc3ZnTmFtZXNbaV0uc2V0QXR0cmlidXRlKCd5JywgKG5hbWVQb3NpdGlvbi55ICogc2NhbGluZykudG9TdHJpbmcoKSlcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gY3JlYXRlU1ZHUG9pbnQocmFkaXVzOiBzdHJpbmcpOiBTVkdDaXJjbGVFbGVtZW50IHtcbiAgICBjb25zdCBjID0gY3JlYXRlU3ZnRWxlbWVudCgnY2lyY2xlJykgYXMgU1ZHQ2lyY2xlRWxlbWVudFxuICAgIGMuc2V0QXR0cmlidXRlKCdyJywgcmFkaXVzKVxuICAgIHJldHVybiBjXG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVN2Z1RleHQoY29udGVudDogc3RyaW5nKTogU1ZHVGV4dEVsZW1lbnQge1xuICAgIGNvbnN0IHRleHQgPSBjcmVhdGVTdmdFbGVtZW50KCd0ZXh0JykgYXMgU1ZHVGV4dEVsZW1lbnRcbiAgICB0ZXh0LnNldEF0dHJpYnV0ZSgndGV4dC1hbmNob3InLCAnbWlkZGxlJylcbiAgICB0ZXh0LnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnZm9udC1zaXplOiAxNXB4JylcbiAgICB0ZXh0LmlubmVySFRNTCA9IGNvbnRlbnRcbiAgICByZXR1cm4gdGV4dFxufVxuXG5mdW5jdGlvbiBjcmVhdGVTVkdMaW5lKFxuICAgIG9wdGlvbnM6IHsgc3Ryb2tlPzogc3RyaW5nLCBzdHJva2VXaWR0aD86IHN0cmluZywgb3BhY2l0eT86IHN0cmluZyB9ID0ge31cbik6IFNWR0xpbmVFbGVtZW50IHtcbiAgICBjb25zdCBsaW5lID0gY3JlYXRlU3ZnRWxlbWVudCgnbGluZScpIGFzIFNWR0xpbmVFbGVtZW50XG4gICAgbGluZS5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsIG9wdGlvbnMuc3Ryb2tlIHx8ICdibGFjaycpXG4gICAgaWYgKHR5cGVvZiBvcHRpb25zLnN0cm9rZVdpZHRoICE9PSAndW5kZWZpbmVkJylcbiAgICAgICAgbGluZS5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS13aWR0aCcsIG9wdGlvbnMuc3Ryb2tlV2lkdGgpXG4gICAgaWYgKHR5cGVvZiBvcHRpb25zLm9wYWNpdHkgIT09ICd1bmRlZmluZWQnKVxuICAgICAgICBsaW5lLnNldEF0dHJpYnV0ZSgnb3BhY2l0eScsIG9wdGlvbnMub3BhY2l0eSlcbiAgICByZXR1cm4gbGluZVxufVxuXG5mdW5jdGlvbiBjcmVhdGVTdmdFbGVtZW50KHRhZ05hbWU6IHN0cmluZyk6IFNWR0VsZW1lbnQge1xuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgdGFnTmFtZSlcbn1cbiIsImltcG9ydCBUcmlhbmdsZURyYXdpbmcgZnJvbSAnLi90cmlhbmdsZURyYXdpbmcnXG5cbmZ1bmN0aW9uIGNyZWF0ZUhUTUxUcmlhbmdsZShcbiAgICBzdmdJZDogc3RyaW5nLFxuICAgIGxlZnRSb3RhdGVCdXR0b25JZDogc3RyaW5nLFxuICAgIHJpZ2h0Um90YXRlQnV0dG9uSWQ6IHN0cmluZyxcbik6IHZvaWQge1xuICAgIGNvbnN0IHN2ZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHN2Z0lkKVxuICAgIGNvbnN0IGxlZnRSb3RhdGVCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChsZWZ0Um90YXRlQnV0dG9uSWQpXG4gICAgY29uc3QgcmlnaHRSb3RhdGVCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyaWdodFJvdGF0ZUJ1dHRvbklkKVxuICAgIGlmIChzdmcgPT09IG51bGwpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gU1ZHIGVsZW1lbnQgd2l0aCByZXF1ZXN0ZWQgSUQnKVxuICAgIGlmIChsZWZ0Um90YXRlQnV0dG9uID09PSBudWxsIHx8IHJpZ2h0Um90YXRlQnV0dG9uID09PSBudWxsKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGJ1dHRvbiB3aXRoIHJlcXVlc3RlZCBJRCcpXG5cbiAgICBjb25zdCBkcmF3aW5nID0gbmV3IFRyaWFuZ2xlRHJhd2luZyhzdmcpXG4gICAgbGVmdFJvdGF0ZUJ1dHRvbi5vbmNsaWNrID0gKCkgPT4gZHJhd2luZy5hbmltYXRlVHJpYW5nbGVSb3RhdGlvbigtMSlcbiAgICByaWdodFJvdGF0ZUJ1dHRvbi5vbmNsaWNrID0gKCkgPT4gZHJhd2luZy5hbmltYXRlVHJpYW5nbGVSb3RhdGlvbigxKVxufVxuXG5jcmVhdGVIVE1MVHJpYW5nbGUoJ2xlZnQtdHJpYW5nbGUnLCAnbGVmdC1yb3RhdGUtMScsICdsZWZ0LXJvdGF0ZS0yJylcbmNyZWF0ZUhUTUxUcmlhbmdsZSgncmlnaHQtdHJpYW5nbGUnLCAncmlnaHQtcm90YXRlLTEnLCAncmlnaHQtcm90YXRlLTInKVxuIl0sInNvdXJjZVJvb3QiOiIifQ==
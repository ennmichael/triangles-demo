!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";function n(t,e,i){const n=(r=e.a,{x:(s=e.b).x-r.x,y:s.y-r.y});var r,s;return{x:t.x+n.x*i,y:t.y+n.y*i}}function r(t,e){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}}function s(t,e){const i=Math.cos(e),n=Math.sin(e);return t.map(({x:t,y:e})=>({x:t*i-e*n,y:t*n+e*i}))}i.r(e);const o=100;class a{constructor(t){this.svg=t,this.triangle=function(){const t=.5*Math.sqrt(3);return[{x:0,y:-2*t/3},{x:.5,y:t/3},{x:-.5,y:t/3}]}(),this.svgPoints=[c("1.2"),c("1.2"),c("1.2")],this.svgSides=[u(),u(),u()],this.svgHeights=[u({stroke:"grey",strokeWidth:"3",opacity:"0.4"}),u({stroke:"grey",strokeWidth:"3",opacity:"0.4"}),u({stroke:"grey",strokeWidth:"3",opacity:"0.4"})];for(let t=0;t<this.svgHeights.length;++t)switch(this.svgHeights[t].setAttribute("cursor","pointer"),t){case 0:this.svgHeights[t].onclick=()=>this.animatePointSwap(1,2);break;case 1:this.svgHeights[t].onclick=()=>this.animatePointSwap(0,2);break;case 2:this.svgHeights[t].onclick=()=>this.animatePointSwap(1,0)}t.append(...this.svgHeights),t.append(...this.svgSides),t.append(...this.svgPoints),this.draw(),setInterval(()=>{if(void 0!==this.animation){const{value:t,done:e}=this.animation.next();e?this.animation=void 0:this.triangle=t,this.draw()}})}animateTriangleRotation(t){void 0===this.animation&&(this.animation=function*(t,e,i){const n=2*i*Math.PI/3;let r=0;for(;r<=1;r+=1e-4*t)yield s(e,n*r);1!==r&&(yield s(e,n))}(o,this.triangle,t))}animatePointSwap(t,e){void 0===this.animation&&(this.animation=function*(t,e,i,r){const s={a:e[i],b:e[r]},o={a:e[r],b:e[i]};let a=0;for(;a<=1;a+=1e-4*t){const t=[...e];t[i]=n(e[i],s,a),t[r]=n(e[r],o,a),yield t}if(1!==a){const t=[...e];t[i]=e[r],t[r]=e[i],yield t}}(o,this.triangle,t,e))}draw(){const t=[{a:r((e=this.triangle)[1],e[2]),b:e[0]},{a:r(e[0],e[2]),b:e[1]},{a:r(e[0],e[1]),b:e[2]}];var e;const i=function(t){return[{a:t[0],b:t[1]},{a:t[1],b:t[2]},{a:t[2],b:t[0]}]}(this.triangle);for(let e=0;e<this.triangle.length;++e){const n=this.triangle[e],r=t[e],s=i[e];this.svgHeights[e].setAttribute("x1",(150*r.a.x).toString()),this.svgHeights[e].setAttribute("y1",(150*r.a.y).toString()),this.svgHeights[e].setAttribute("x2",(150*r.b.x).toString()),this.svgHeights[e].setAttribute("y2",(150*r.b.y).toString()),this.svgSides[e].setAttribute("x1",(150*s.a.x).toString()),this.svgSides[e].setAttribute("y1",(150*s.a.y).toString()),this.svgSides[e].setAttribute("x2",(150*s.b.x).toString()),this.svgSides[e].setAttribute("y2",(150*s.b.y).toString()),this.svgPoints[e].setAttribute("cx",(150*n.x).toString()),this.svgPoints[e].setAttribute("cy",(150*n.y).toString())}}}function c(t){const e=g("circle");return e.setAttribute("r",t),e}function u(t={}){const e=g("line");return e.setAttribute("stroke",t.stroke||"black"),void 0!==t.strokeWidth&&e.setAttribute("stroke-width",t.strokeWidth),void 0!==t.opacity&&e.setAttribute("opacity",t.opacity),e}function g(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function h(t,e,i){const n=document.getElementById(t),r=document.getElementById(e),s=document.getElementById(i);if(null===n)throw new Error("No SVG element with requested ID");if(null===r||null===s)throw new Error("No button with requested ID");const o=new a(n);r.onclick=()=>o.animateTriangleRotation(1),s.onclick=()=>o.animateTriangleRotation(-1)}h("left-triangle","left-rotate-1","left-rotate-2"),h("right-triangle","right-rotate-1","right-rotate-2")}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2dlb21ldHJ5LnRzIiwid2VicGFjazovLy8uL3NyYy90cmlhbmdsZURyYXdpbmcudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2FuaW1hdGlvbnMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwidHJhbnNsYXRlIiwiZGlzIiwicDEiLCJhIiwieCIsInAyIiwiYiIsInkiLCJtaWRwb2ludCIsInJvdGF0ZVRyaWFuZ2xlIiwiYW5nbGUiLCJjb3MiLCJNYXRoIiwic2luIiwibWFwIiwic3ZnIiwidHJpYW5nbGUiLCJoIiwic3FydCIsImNyZWF0ZVRyaWFuZ2xlIiwic3ZnUG9pbnRzIiwiY3JlYXRlU1ZHUG9pbnQiLCJzdmdTaWRlcyIsImNyZWF0ZVNWR0xpbmUiLCJzdmdIZWlnaHRzIiwic3Ryb2tlIiwic3Ryb2tlV2lkdGgiLCJvcGFjaXR5IiwidGhpcyIsImxlbmd0aCIsInNldEF0dHJpYnV0ZSIsIm9uY2xpY2siLCJhbmltYXRlUG9pbnRTd2FwIiwiYXBwZW5kIiwiZHJhdyIsInNldEludGVydmFsIiwidW5kZWZpbmVkIiwiYW5pbWF0aW9uIiwibmV3VHJpYW5nbGUiLCJkb25lIiwibmV4dCIsImRpcmVjdGlvbiIsInRpbWVzdGVwIiwiUEkiLCJ0cmlhbmdsZVJvdGF0ZUFuaW1hdGlvbiIsImZpcnN0UG9pbnRJbmRleCIsInNlY29uZFBvaW50SW5kZXgiLCJmaXJzdFRvU2Vjb25kIiwic2Vjb25kVG9GaXJzdCIsInBvaW50U3dhcEFuaW1hdGlvbiIsImhlaWdodHMiLCJzaWRlcyIsInRyaWFuZ2xlU2lkZXMiLCJ0b1N0cmluZyIsInJhZGl1cyIsImNyZWF0ZVN2Z0VsZW1lbnQiLCJvcHRpb25zIiwibGluZSIsInRhZ05hbWUiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnROUyIsImNyZWF0ZUhUTUxUcmlhbmdsZSIsInN2Z0lkIiwibGVmdFJvdGF0ZUJ1dHRvbklkIiwicmlnaHRSb3RhdGVCdXR0b25JZCIsImdldEVsZW1lbnRCeUlkIiwibGVmdFJvdGF0ZUJ1dHRvbiIsInJpZ2h0Um90YXRlQnV0dG9uIiwiRXJyb3IiLCJkcmF3aW5nIiwiYW5pbWF0ZVRyaWFuZ2xlUm90YXRpb24iXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElBQUlDLEVBQVNKLEVBQWlCRSxHQUFZLENBQ3pDRyxFQUFHSCxFQUNISSxHQUFHLEVBQ0hILFFBQVMsSUFVVixPQU5BSSxFQUFRTCxHQUFVTSxLQUFLSixFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTRixHQUcvREcsRUFBT0UsR0FBSSxFQUdKRixFQUFPRCxRQUtmRixFQUFvQlEsRUFBSUYsRUFHeEJOLEVBQW9CUyxFQUFJVixFQUd4QkMsRUFBb0JVLEVBQUksU0FBU1IsRUFBU1MsRUFBTUMsR0FDM0NaLEVBQW9CYSxFQUFFWCxFQUFTUyxJQUNsQ0csT0FBT0MsZUFBZWIsRUFBU1MsRUFBTSxDQUFFSyxZQUFZLEVBQU1DLElBQUtMLEtBS2hFWixFQUFvQmtCLEVBQUksU0FBU2hCLEdBQ1gsb0JBQVhpQixRQUEw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QVEvQixRQUFVLGNBQ1gsSUFBeEIrQixFQUFROUIsYUFDZitCLEVBQUszQixhQUFhLGVBQWdCMEIsRUFBUTlCLGtCQUNmLElBQXBCOEIsRUFBUTdCLFNBQ2Y4QixFQUFLM0IsYUFBYSxVQUFXMEIsRUFBUTdCLFNBQ2xDOEIsRUFHWCxTQUFTRixFQUFpQkcsR0FDdEIsT0FBT0MsU0FBU0MsZ0JBQWdCLDZCQUE4QkYsR0V6R2xFLFNBQVNHLEVBQ0xDLEVBQ0FDLEVBQ0FDLEdBRUEsTUFBTWpELEVBQU00QyxTQUFTTSxlQUFlSCxHQUM5QkksRUFBbUJQLFNBQVNNLGVBQWVGLEdBQzNDSSxFQUFvQlIsU0FBU00sZUFBZUQsR0FDbEQsR0FBWSxPQUFSakQsRUFDQSxNQUFNLElBQUlxRCxNQUFNLG9DQUNwQixHQUF5QixPQUFyQkYsR0FBbUQsT0FBdEJDLEVBQzdCLE1BQU0sSUFBSUMsTUFBTSwrQkFFcEIsTUFBTUMsRUFBVSxJQUFJLEVBQWdCdEQsR0FDcENtRCxFQUFpQm5DLFFBQVUsSUFBTXNDLEVBQVFDLHdCQUF3QixHQUNqRUgsRUFBa0JwQyxRQUFVLElBQU1zQyxFQUFRQyx5QkFBeUIsR0FHdkVULEVBQW1CLGdCQUFpQixnQkFBaUIsaUJBQ3JEQSxFQUFtQixpQkFBa0IsaUJBQWtCIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImV4cG9ydCBpbnRlcmZhY2UgUG9pbnQge1xuICAgIHJlYWRvbmx5IHg6IG51bWJlclxuICAgIHJlYWRvbmx5IHk6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIExpbmUge1xuICAgIHJlYWRvbmx5IGE6IFBvaW50XG4gICAgcmVhZG9ubHkgYjogUG9pbnRcbn1cblxuZXhwb3J0IHR5cGUgVHJpYW5nbGUgPSByZWFkb25seSBQb2ludFtdXG5cbmV4cG9ydCBmdW5jdGlvbiBkaXNwbGFjZW1lbnQocDE6IFBvaW50LCBwMjogUG9pbnQpOiBQb2ludCB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgeDogcDIueCAtIHAxLngsXG4gICAgICAgIHk6IHAyLnkgLSBwMS55LFxuICAgIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRyYW5zbGF0ZShwOiBQb2ludCwgZDogTGluZSwgdDogbnVtYmVyKTogUG9pbnQge1xuICAgIGNvbnN0IGRpcyA9IGRpc3BsYWNlbWVudChkLmEsIGQuYilcbiAgICByZXR1cm4ge1xuICAgICAgICB4OiBwLnggKyBkaXMueCAqIHQsXG4gICAgICAgIHk6IHAueSArIGRpcy55ICogdCxcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtaWRwb2ludChhOiBQb2ludCwgYjogUG9pbnQpOiBQb2ludCB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgeDogKGEueCArIGIueCkgLyAyLFxuICAgICAgICB5OiAoYS55ICsgYi55KSAvIDIsXG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVHJpYW5nbGUoKTogVHJpYW5nbGUge1xuICAgIGNvbnN0IGEgPSAxXG4gICAgY29uc3QgaCA9IGEgLyAyICogTWF0aC5zcXJ0KDMpXG4gICAgcmV0dXJuIFtcbiAgICAgICAgeyB4OiAwLCB5OiAtMiAqIGggLyAzIH0sXG4gICAgICAgIHsgeDogYSAvIDIsIHk6IGggLyAzIH0sXG4gICAgICAgIHsgeDogLWEgLyAyLCB5OiBoIC8gMyB9LFxuICAgIF1cbn1cblxuLyoqXG4gKiBHZW5lcmF0ZSB0cmlhbmdsZSBoZWlnaHQgbGluZXMuIFRoZSBpdGggbGluZSBpcyBhbHdheXMgY29ubmVjdGVkIHRvIHRoZSBpdGggcG9pbnRcbiAqIGFuZCB0aGUgbWlkZGxlIG9mIHRoZSBvcHBvc2l0ZSBzaWRlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gdHJpYW5nbGVIZWlnaHRzKHQ6IFRyaWFuZ2xlKTogW0xpbmUsIExpbmUsIExpbmVdIHtcbiAgICByZXR1cm4gW1xuICAgICAgICB7IGE6IG1pZHBvaW50KHRbMV0sIHRbMl0pLCBiOiB0WzBdIH0sXG4gICAgICAgIHsgYTogbWlkcG9pbnQodFswXSwgdFsyXSksIGI6IHRbMV0gfSxcbiAgICAgICAgeyBhOiBtaWRwb2ludCh0WzBdLCB0WzFdKSwgYjogdFsyXSB9LFxuICAgIF1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRyaWFuZ2xlU2lkZXModDogVHJpYW5nbGUpOiBbTGluZSwgTGluZSwgTGluZV0ge1xuICAgIHJldHVybiBbXG4gICAgICAgIHsgYTogdFswXSwgYjogdFsxXSB9LFxuICAgICAgICB7IGE6IHRbMV0sIGI6IHRbMl0gfSxcbiAgICAgICAgeyBhOiB0WzJdLCBiOiB0WzBdIH0sXG4gICAgXVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdHJpYW5nbGVDZW50ZXIodDogVHJpYW5nbGUpOiBQb2ludCB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgeDogKHRbMF0ueCArIHRbMV0ueCArIHRbMl0ueCkgLyAzLFxuICAgICAgICB5OiAodFswXS55ICsgdFsxXS55ICsgdFsyXS55KSAvIDMsXG4gICAgfVxufVxuXG4vKipcbiAqIEByZXR1cm5zIFRoZSB0cmlhbmdsZSB0IHJvdGF0ZSBieSBhbmdsZSByYWRpYW5zLlxuICogQHBhcmFtIHQgVGhlIHRhcmdldCB0cmlhbmdsZS5cbiAqIEBwYXJhbSBhbmdsZSBUaGUgcm90YXRpb24gYW5nbGUgaW4gcmFkaWFucy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJvdGF0ZVRyaWFuZ2xlKHQ6IFRyaWFuZ2xlLCBhbmdsZTogbnVtYmVyKTogVHJpYW5nbGUge1xuICAgIGNvbnN0IGNvcyA9IE1hdGguY29zKGFuZ2xlKVxuICAgIGNvbnN0IHNpbiA9IE1hdGguc2luKGFuZ2xlKVxuICAgIHJldHVybiB0Lm1hcCgoeyB4LCB5IH0pID0+ICh7XG4gICAgICAgIHg6IHggKiBjb3MgLSB5ICogc2luLFxuICAgICAgICB5OiB4ICogc2luICsgeSAqIGNvcyxcbiAgICB9KSlcbn1cbiIsImltcG9ydCB7IFRyaWFuZ2xlLCB0cmlhbmdsZUhlaWdodHMsIHRyaWFuZ2xlU2lkZXMsIGNyZWF0ZVRyaWFuZ2xlIH0gZnJvbSBcIi4vZ2VvbWV0cnlcIlxuaW1wb3J0IHsgQW5pbWF0aW9uLCB0cmlhbmdsZVJvdGF0ZUFuaW1hdGlvbiwgcG9pbnRTd2FwQW5pbWF0aW9uIH0gZnJvbSAnLi9hbmltYXRpb25zJ1xuXG5jb25zdCB0aW1lc3RlcCA9IDEwMFxuXG5leHBvcnQgdHlwZSBIZWlnaHRDbGlja0NhbGxiYWNrID0gKCkgPT4gdm9pZFxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUcmlhbmdsZURyYXdpbmcge1xuICAgIHByaXZhdGUgYW5pbWF0aW9uOiBBbmltYXRpb258dW5kZWZpbmVkXG4gICAgcHJpdmF0ZSB0cmlhbmdsZSA9IGNyZWF0ZVRyaWFuZ2xlKClcbiAgICBwcml2YXRlIHN2Z1BvaW50cyA9IFtjcmVhdGVTVkdQb2ludCgnMS4yJyksIGNyZWF0ZVNWR1BvaW50KCcxLjInKSwgY3JlYXRlU1ZHUG9pbnQoJzEuMicpXVxuICAgIHByaXZhdGUgc3ZnU2lkZXMgPSBbY3JlYXRlU1ZHTGluZSgpLCBjcmVhdGVTVkdMaW5lKCksIGNyZWF0ZVNWR0xpbmUoKV1cbiAgICBwcml2YXRlIHN2Z0hlaWdodHMgPSBbXG4gICAgICAgIGNyZWF0ZVNWR0xpbmUoeyBzdHJva2U6ICdncmV5Jywgc3Ryb2tlV2lkdGg6ICczJywgb3BhY2l0eTogJzAuNCcgfSksXG4gICAgICAgIGNyZWF0ZVNWR0xpbmUoeyBzdHJva2U6ICdncmV5Jywgc3Ryb2tlV2lkdGg6ICczJywgb3BhY2l0eTogJzAuNCcgfSksXG4gICAgICAgIGNyZWF0ZVNWR0xpbmUoeyBzdHJva2U6ICdncmV5Jywgc3Ryb2tlV2lkdGg6ICczJywgb3BhY2l0eTogJzAuNCcgfSksXG4gICAgXVxuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBzdmc6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5zdmdIZWlnaHRzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB0aGlzLnN2Z0hlaWdodHNbaV0uc2V0QXR0cmlidXRlKCdjdXJzb3InLCAncG9pbnRlcicpXG4gICAgICAgICAgICBzd2l0Y2ggKGkpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3ZnSGVpZ2h0c1tpXS5vbmNsaWNrID0gKCkgPT4gdGhpcy5hbmltYXRlUG9pbnRTd2FwKDEsIDIpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN2Z0hlaWdodHNbaV0ub25jbGljayA9ICgpID0+IHRoaXMuYW5pbWF0ZVBvaW50U3dhcCgwLCAyKVxuICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdmdIZWlnaHRzW2ldLm9uY2xpY2sgPSAoKSA9PiB0aGlzLmFuaW1hdGVQb2ludFN3YXAoMSwgMClcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHN2Zy5hcHBlbmQoLi4udGhpcy5zdmdIZWlnaHRzKVxuICAgICAgICBzdmcuYXBwZW5kKC4uLnRoaXMuc3ZnU2lkZXMpXG4gICAgICAgIHN2Zy5hcHBlbmQoLi4udGhpcy5zdmdQb2ludHMpXG5cbiAgICAgICAgdGhpcy5kcmF3KClcblxuICAgICAgICBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5hbmltYXRpb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgdmFsdWU6IG5ld1RyaWFuZ2xlLCBkb25lIH0gPSB0aGlzLmFuaW1hdGlvbi5uZXh0KClcbiAgICAgICAgICAgICAgICBpZiAoIWRvbmUpXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHJpYW5nbGUgPSBuZXdUcmlhbmdsZVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hbmltYXRpb24gPSB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICB0aGlzLmRyYXcoKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIHB1YmxpYyBhbmltYXRlVHJpYW5nbGVSb3RhdGlvbihkaXJlY3Rpb246IG51bWJlcikge1xuICAgICAgICBpZiAodGhpcy5hbmltYXRpb24gIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB0aGlzLmFuaW1hdGlvbiA9IHRyaWFuZ2xlUm90YXRlQW5pbWF0aW9uKHRpbWVzdGVwLCB0aGlzLnRyaWFuZ2xlLCBkaXJlY3Rpb24pXG4gICAgfVxuXG4gICAgcHVibGljIGFuaW1hdGVQb2ludFN3YXAoZmlyc3RQb2ludEluZGV4OiBudW1iZXIsIHNlY29uZFBvaW50SW5kZXg6IG51bWJlcikge1xuICAgICAgICBpZiAodGhpcy5hbmltYXRpb24gIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB0aGlzLmFuaW1hdGlvbiA9IHBvaW50U3dhcEFuaW1hdGlvbih0aW1lc3RlcCwgdGhpcy50cmlhbmdsZSwgZmlyc3RQb2ludEluZGV4LCBzZWNvbmRQb2ludEluZGV4KVxuICAgIH1cblxuICAgIHByaXZhdGUgZHJhdygpOiB2b2lkIHtcbiAgICAgICAgY29uc3Qgc2lkZVNjYWxlID0gMTUwXG4gICAgICAgIGNvbnN0IGhlaWdodHMgPSB0cmlhbmdsZUhlaWdodHModGhpcy50cmlhbmdsZSlcbiAgICAgICAgY29uc3Qgc2lkZXMgPSB0cmlhbmdsZVNpZGVzKHRoaXMudHJpYW5nbGUpXG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnRyaWFuZ2xlLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICBjb25zdCBwID0gdGhpcy50cmlhbmdsZVtpXVxuICAgICAgICAgICAgY29uc3QgaCA9IGhlaWdodHNbaV1cbiAgICAgICAgICAgIGNvbnN0IHMgPSBzaWRlc1tpXVxuXG4gICAgICAgICAgICB0aGlzLnN2Z0hlaWdodHNbaV0uc2V0QXR0cmlidXRlKCd4MScsIChoLmEueCAqIHNpZGVTY2FsZSkudG9TdHJpbmcoKSlcbiAgICAgICAgICAgIHRoaXMuc3ZnSGVpZ2h0c1tpXS5zZXRBdHRyaWJ1dGUoJ3kxJywgKGguYS55ICogc2lkZVNjYWxlKS50b1N0cmluZygpKVxuICAgICAgICAgICAgdGhpcy5zdmdIZWlnaHRzW2ldLnNldEF0dHJpYnV0ZSgneDInLCAoaC5iLnggKiBzaWRlU2NhbGUpLnRvU3RyaW5nKCkpXG4gICAgICAgICAgICB0aGlzLnN2Z0hlaWdodHNbaV0uc2V0QXR0cmlidXRlKCd5MicsIChoLmIueSAqIHNpZGVTY2FsZSkudG9TdHJpbmcoKSlcbiAgICAgICAgICAgIHRoaXMuc3ZnU2lkZXNbaV0uc2V0QXR0cmlidXRlKCd4MScsIChzLmEueCAqIHNpZGVTY2FsZSkudG9TdHJpbmcoKSlcbiAgICAgICAgICAgIHRoaXMuc3ZnU2lkZXNbaV0uc2V0QXR0cmlidXRlKCd5MScsIChzLmEueSAqIHNpZGVTY2FsZSkudG9TdHJpbmcoKSlcbiAgICAgICAgICAgIHRoaXMuc3ZnU2lkZXNbaV0uc2V0QXR0cmlidXRlKCd4MicsIChzLmIueCAqIHNpZGVTY2FsZSkudG9TdHJpbmcoKSlcbiAgICAgICAgICAgIHRoaXMuc3ZnU2lkZXNbaV0uc2V0QXR0cmlidXRlKCd5MicsIChzLmIueSAqIHNpZGVTY2FsZSkudG9TdHJpbmcoKSlcbiAgICAgICAgICAgIHRoaXMuc3ZnUG9pbnRzW2ldLnNldEF0dHJpYnV0ZSgnY3gnLCAocC54ICogc2lkZVNjYWxlKS50b1N0cmluZygpKVxuICAgICAgICAgICAgdGhpcy5zdmdQb2ludHNbaV0uc2V0QXR0cmlidXRlKCdjeScsIChwLnkgKiBzaWRlU2NhbGUpLnRvU3RyaW5nKCkpXG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVNWR1BvaW50KHJhZGl1czogc3RyaW5nKTogU1ZHQ2lyY2xlRWxlbWVudCB7XG4gICAgY29uc3QgYyA9IGNyZWF0ZVN2Z0VsZW1lbnQoJ2NpcmNsZScpIGFzIFNWR0NpcmNsZUVsZW1lbnRcbiAgICBjLnNldEF0dHJpYnV0ZSgncicsIHJhZGl1cylcbiAgICByZXR1cm4gY1xufVxuXG5mdW5jdGlvbiBjcmVhdGVTVkdMaW5lKFxuICAgIG9wdGlvbnM6IHsgc3Ryb2tlPzogc3RyaW5nLCBzdHJva2VXaWR0aD86IHN0cmluZywgb3BhY2l0eT86IHN0cmluZyB9ID0ge31cbik6IFNWR0xpbmVFbGVtZW50IHtcbiAgICBjb25zdCBsaW5lID0gY3JlYXRlU3ZnRWxlbWVudCgnbGluZScpIGFzIFNWR0xpbmVFbGVtZW50XG4gICAgbGluZS5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsIG9wdGlvbnMuc3Ryb2tlIHx8ICdibGFjaycpXG4gICAgaWYgKHR5cGVvZiBvcHRpb25zLnN0cm9rZVdpZHRoICE9PSAndW5kZWZpbmVkJylcbiAgICAgICAgbGluZS5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS13aWR0aCcsIG9wdGlvbnMuc3Ryb2tlV2lkdGgpXG4gICAgaWYgKHR5cGVvZiBvcHRpb25zLm9wYWNpdHkgIT09ICd1bmRlZmluZWQnKVxuICAgICAgICBsaW5lLnNldEF0dHJpYnV0ZSgnb3BhY2l0eScsIG9wdGlvbnMub3BhY2l0eSlcbiAgICByZXR1cm4gbGluZVxufVxuXG5mdW5jdGlvbiBjcmVhdGVTdmdFbGVtZW50KHRhZ05hbWU6IHN0cmluZyk6IFNWR0VsZW1lbnQge1xuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgdGFnTmFtZSlcbn1cbiIsImltcG9ydCB7IFRyaWFuZ2xlLCByb3RhdGVUcmlhbmdsZSwgZGlzcGxhY2VtZW50LCB0cmFuc2xhdGUgfSBmcm9tIFwiLi9nZW9tZXRyeVwiXG5cbi8qKlxuICogQW4gYW5pbWF0aW9uIGlzIGp1c3QgYSBmdW5jdGlvbiB3aGljaCByZXR1cm5zIGRpZmZlcmVudCB0cmlhbmdsZXMgd2l0aCB0aW1lLlxuICogXG4gKi9cbmV4cG9ydCB0eXBlIEFuaW1hdGlvbiA9IEl0ZXJhYmxlSXRlcmF0b3I8VHJpYW5nbGU+XG5cbi8qKlxuICogQHJldHVybnMgQW4gYW5pbWF0aW9uIHdoaWNoIG1vdmVzIHRoZSB0d28gcG9pbnRzIHNvIHRoYXQgdGhleSBlbmQgdXAgc3dhcHBlZC5cbiAqIEBwYXJhbSB0IFRoZSB0YXJnZXQgdHJpYW5nbGUuXG4gKiBAcGFyYW0gZmlyc3RQb2ludEluZGV4IEluZGV4IG9mIGZpcnN0IHBvaW50IHRvIG1vdmUuXG4gKiBAcGFyYW0gc2Vjb25kUG9pbnRJbmRleCBJbmRleCBvZiBzZWNvbmQgcG9pbnQgdG8gbW92ZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uICogcG9pbnRTd2FwQW5pbWF0aW9uKFxuICAgIHRpbWVzdGVwOiBudW1iZXIsXG4gICAgdHJpYW5nbGU6IFRyaWFuZ2xlLFxuICAgIGZpcnN0UG9pbnRJbmRleDogbnVtYmVyLFxuICAgIHNlY29uZFBvaW50SW5kZXg6IG51bWJlcixcbik6IEl0ZXJhYmxlSXRlcmF0b3I8VHJpYW5nbGU+IHtcbiAgICBjb25zdCBzcGVlZCA9IDFlLTRcbiAgICBjb25zdCBmaXJzdFRvU2Vjb25kID0geyBhOiB0cmlhbmdsZVtmaXJzdFBvaW50SW5kZXhdLCBiOiB0cmlhbmdsZVtzZWNvbmRQb2ludEluZGV4XSB9XG4gICAgY29uc3Qgc2Vjb25kVG9GaXJzdCA9IHsgYTogdHJpYW5nbGVbc2Vjb25kUG9pbnRJbmRleF0sIGI6IHRyaWFuZ2xlW2ZpcnN0UG9pbnRJbmRleF0gfVxuICAgIGxldCB0ID0gMFxuXG4gICAgZm9yICh0OyB0IDw9IDE7IHQgKz0gc3BlZWQgKiB0aW1lc3RlcCkge1xuICAgICAgICBjb25zdCBuZXdUcmlhbmdsZSA9IFsuLi50cmlhbmdsZV1cbiAgICAgICAgbmV3VHJpYW5nbGVbZmlyc3RQb2ludEluZGV4XSA9IHRyYW5zbGF0ZSh0cmlhbmdsZVtmaXJzdFBvaW50SW5kZXhdLCBmaXJzdFRvU2Vjb25kLCB0KVxuICAgICAgICBuZXdUcmlhbmdsZVtzZWNvbmRQb2ludEluZGV4XSA9IHRyYW5zbGF0ZSh0cmlhbmdsZVtzZWNvbmRQb2ludEluZGV4XSwgc2Vjb25kVG9GaXJzdCwgdClcbiAgICAgICAgeWllbGQgbmV3VHJpYW5nbGVcbiAgICB9XG5cbiAgICBpZiAodCAhPT0gMSkge1xuICAgICAgICBjb25zdCBuZXdUcmlhbmdsZSA9IFsuLi50cmlhbmdsZV1cbiAgICAgICAgbmV3VHJpYW5nbGVbZmlyc3RQb2ludEluZGV4XSA9IHRyaWFuZ2xlW3NlY29uZFBvaW50SW5kZXhdXG4gICAgICAgIG5ld1RyaWFuZ2xlW3NlY29uZFBvaW50SW5kZXhdID0gdHJpYW5nbGVbZmlyc3RQb2ludEluZGV4XVxuICAgICAgICB5aWVsZCBuZXdUcmlhbmdsZVxuICAgIH1cbn1cblxuLyoqXG4gKiBAcmV0dXJucyBBbiBhbmltYXRpb24gd2hpY2ggcm90YXRlcyB0aGUgZ2l2ZW4gdHJpYW5nbGUgZm9yIDEyMCBkZWdyZWVzLlxuICogQHBhcmFtIHQgVGhlIHRyaWFuZ2xlIHRvIHJvdGF0ZS5cbiAqIEBwYXJhbSBkaXJlY3Rpb24gVGhlIHJvdGF0aW9uIGRpcmVjdGlvbi4gMSBtZWFucyAxMjAgZGVncmVlcywgLTEgbWVhbnMgLTEyMCBkZWdyZWVzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gKiB0cmlhbmdsZVJvdGF0ZUFuaW1hdGlvbihcbiAgICB0aW1lc3RlcDogbnVtYmVyLFxuICAgIHRyaWFuZ2xlOiBUcmlhbmdsZSxcbiAgICBkaXJlY3Rpb246IG51bWJlcixcbik6IEl0ZXJhYmxlSXRlcmF0b3I8VHJpYW5nbGU+IHtcbiAgICBjb25zdCBzcGVlZCA9IDFlLTRcbiAgICBjb25zdCBhbmdsZSA9IGRpcmVjdGlvbiAqIDIgKiBNYXRoLlBJIC8gM1xuICAgIGxldCB0ID0gMFxuXG4gICAgZm9yICh0OyB0IDw9IDE7IHQgKz0gc3BlZWQgKiB0aW1lc3RlcClcbiAgICAgICAgeWllbGQgcm90YXRlVHJpYW5nbGUodHJpYW5nbGUsIGFuZ2xlICogdClcblxuICAgIGlmICh0ICE9PSAxKVxuICAgICAgICB5aWVsZCByb3RhdGVUcmlhbmdsZSh0cmlhbmdsZSwgYW5nbGUpXG59XG4iLCJpbXBvcnQgVHJpYW5nbGVEcmF3aW5nIGZyb20gJy4vdHJpYW5nbGVEcmF3aW5nJ1xuXG5mdW5jdGlvbiBjcmVhdGVIVE1MVHJpYW5nbGUoXG4gICAgc3ZnSWQ6IHN0cmluZyxcbiAgICBsZWZ0Um90YXRlQnV0dG9uSWQ6IHN0cmluZyxcbiAgICByaWdodFJvdGF0ZUJ1dHRvbklkOiBzdHJpbmcsXG4pOiB2b2lkIHtcbiAgICBjb25zdCBzdmcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzdmdJZClcbiAgICBjb25zdCBsZWZ0Um90YXRlQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobGVmdFJvdGF0ZUJ1dHRvbklkKVxuICAgIGNvbnN0IHJpZ2h0Um90YXRlQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmlnaHRSb3RhdGVCdXR0b25JZClcbiAgICBpZiAoc3ZnID09PSBudWxsKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIFNWRyBlbGVtZW50IHdpdGggcmVxdWVzdGVkIElEJylcbiAgICBpZiAobGVmdFJvdGF0ZUJ1dHRvbiA9PT0gbnVsbCB8fCByaWdodFJvdGF0ZUJ1dHRvbiA9PT0gbnVsbClcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBidXR0b24gd2l0aCByZXF1ZXN0ZWQgSUQnKVxuXG4gICAgY29uc3QgZHJhd2luZyA9IG5ldyBUcmlhbmdsZURyYXdpbmcoc3ZnKVxuICAgIGxlZnRSb3RhdGVCdXR0b24ub25jbGljayA9ICgpID0+IGRyYXdpbmcuYW5pbWF0ZVRyaWFuZ2xlUm90YXRpb24oMSlcbiAgICByaWdodFJvdGF0ZUJ1dHRvbi5vbmNsaWNrID0gKCkgPT4gZHJhd2luZy5hbmltYXRlVHJpYW5nbGVSb3RhdGlvbigtMSlcbn1cblxuY3JlYXRlSFRNTFRyaWFuZ2xlKCdsZWZ0LXRyaWFuZ2xlJywgJ2xlZnQtcm90YXRlLTEnLCAnbGVmdC1yb3RhdGUtMicpXG5jcmVhdGVIVE1MVHJpYW5nbGUoJ3JpZ2h0LXRyaWFuZ2xlJywgJ3JpZ2h0LXJvdGF0ZS0xJywgJ3JpZ2h0LXJvdGF0ZS0yJylcbiJdLCJzb3VyY2VSb290IjoiIn0=